TKYTEL COMMENT 9
                                                          東京広域電話網
                                                               上羽 未栞
                                                              2025-06-28

          交換局ホップを利用した Fraggle 攻撃の可能性について

1. 概要

    東京広域電話網（以下、網とする）においては、交換局ホップ（以下、ホ
  ップとする）を利用することにより、直接接続されていない交換局（以下、
  局とする）であっても通信できる。本稿では、ホップを利用することで中継
  局の端末に対して Fraggle 攻撃を実現できることを示唆する。

2. 手法

    攻撃を成立させるために最低限必要な条件を以下に示す。

  - 局 P がある。この局には、発信可能な端末 A がある。この端末が攻撃者
    となる。
  - 局 Q がある。この局には、ホップのサポートがある。この局が被害者と
    なる。
  - 局 R がある。この局には、自動発信疑似端末 B がある。例えば、モーニ
    ングコールがこれにあたる。
  - P-Q 間、及び Q-R 間が直接接続されている。また、P から Q を経由して
    R に発信できる。
  - それぞれの局は発信者番号を着信局に通知できる。

    ここで、次の手順によれば、Fraggle 攻撃を実現できる。ただし、局 X
  へのプレフィクス番号を #X とし、端末 T の内線番号を xT とする。これ
  らを用い、X の T への呼出番号を #X-xT とする。また、ホップ用のプレフ
  ィクスを 0 とする。

  1.  P の A の内線番号を任意に設定する。
  2.  P の A から #Q-0-#R-xB に発信する。
    a.  このとき、P は P の A から Q の 0-#R-xB に発信したように思う。
    b.  このとき、Q は P の xA から R の xB に発信したように思う。
    c.  このとき、R は Q の xA から R の xB に発信したように思う。
  3.  P の A からの発信が R の B へ着信する。
  4.  R の B から折返して #Q-xA に発信する。
    a.  このとき、R は R の B から Q の xA に発信したように思う。
    b.  このとき、Q は R の xB から Q の xA に発信したように思う。
  5.  R の B からの折返し発信が Q の A へ着信する（存在すれば）。

3. 経緯

    ホップの際に発信者の番号を適切に処理していないことによる。

4. 想定されるリスク

    多数の自動発信疑似端末から特定の端末（特に、疑似端末やダイヤルアッ
  プサーバなど）に対して発信することで、DoS 攻撃を実現でき得る。

5. 処置

    ホップ時に発信者番号を適切に処理することが求められる。しかし、この
  具体的な手法は未発見である。

6. 備考

    局ホップにおいて、同じ経路を逆順に辿れることは保証されない。

7. 対策

    しっかりする。

                                                                    以上
