TKYTEL COMMENT 19

スクラ
2025-11-16

Tailscale の認証期限切れ回避方法

1. 概要

　Tailscale の key が Expired になるのを回避する方法について述べる。Tailscale で認証を行ったマシンは、 180 日経過すると key の有効期限が切れ、自動的にログアウトする。自動ログアウトを無効にすることで認証期限切れを防ぐことができる。

2. 経緯

　スクラ局（scuraieden）の Mikopbx が Tailscale 上で Expired になり、他局と接続できない状態になっていた。再認証を行ったうえで、180 日経過での自動ログアウトを無効とした。

3. 方法

3.1. Tailscale の再認証

　まず、 Tailscale の再認証を行う。Mikopbx の Docker コンテナを動かしている Ubuntu にログインし、以下のように操作する。

    $ sudo tailscale logout
    $ sudo tailscale up --accept-dns=false

　ブラウザが起動するので Tailscale の認証を行う。

3.2. 自動ログアウトの無効化

　続いて、自動ログアウトを無効にする作業を行う。
　Tailscale の Machines のページを開く。自局の行の右端にある「…」をクリックする。選択肢の中から「disable key expiry」を押下することで、 Tailscale の自動ログアウトをオフにすることができる。

4. 備考

　Tailscale のログアウト機能がデフォルトでオンになっているのはセキュリティ対策のためである。今回は東京広域電話網の接続者を信頼し本操作を行った。当然ながら用途や接続先によっては本操作を行うべきではない。

5. 謝辞

　Tailscale の再認証方法については、東京広域電話網 Discord サーバーの[yude 氏による書き込み]によった。深く感謝の意を表する。

6. 文献

[yude 氏による書き込み]: <https://discord.com/channels/1347594081869500477/1365578972993290260/1366036912250294343>.
(accessed 2025-11-15)

以上